<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Completed Pieces</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            text-align: center;
        }

        h1 {
            margin: 1rem 0 0.5rem;
            font-size: 2rem;
        }

        /* Container for the fetched header */
        #header {
            margin-bottom: 1rem;
        }

        /* Basic styling for the top nav (defined in header.html, but we can style here) */
        .top-nav ul {
            list-style: none;
            padding: 0;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            gap: 2rem;
            border: 2px solid #ccc;
            max-width: 500px;
            margin-bottom: 2rem;
        }

        .top-nav li {
            flex: 1;
        }

        .top-nav a {
            display: block;
            padding: 0.5rem 1rem;
            text-decoration: none;
            color: #000;
            font-weight: bold;
        }

        /* Highlight class for the active page */
        .top-nav a.active {
            background-color: #ddd;
        }

        /* A simple responsive grid for completed pottery items */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            width: 80%;
            margin: 0 auto 2rem;
        }

        .gallery-item {
            border: 1px solid #ccc;
            padding: 1rem;
            background-color: #f9f9f9;
            text-align: left; /* left-align for clarity */
        }

        /* FRAME that holds each pottery image */
        .image-frame {
            width: 200px;           /* set a desired width */
            height: 200px;          /* set a desired height */
            border: 2px solid #ccc;
            background-color: #eee; /* fallback background */
            overflow: hidden;       /* hide any overflow if image is bigger */
            display: flex;          /* center the image inside the frame */
            justify-content: center;
            align-items: center;
            margin-bottom: 0.5rem;  /* space under the frame */
        }

        /* Make the image fill the frame nicely */
        .image-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .description {
            font-size: 0.95rem;
            color: #333;
            margin-bottom: 0.5rem;
        }

        /* The static "Description" text below each piece */
        .static-description {
            font-size: 0.9rem;
            font-style: italic;
            color: #555;
        }
    </style>
</head>
<body>

<h1>Completed Pottery Pieces</h1>

<!-- Where our menu (header.html) will be injected -->
<div id="header"></div>

<!-- Script to fetch the shared header and highlight the "Completed pieces" link -->
<script>
    fetch('header.html')
        .then(response => response.text())
        .then(data => {
            // Inject the header HTML
            document.getElementById('header').innerHTML = data;

            // Highlight the "Completed pieces" link
            const navLinks = document.querySelectorAll('nav a');
            navLinks.forEach(link => {
                if (link.textContent.trim() === 'Completed pieces') {
                    link.classList.add('active');
                }
            });
        });
</script>

<div class="gallery" id="gallery">
    <!-- Galerii täidetakse JavaScript abil andmebaasist -->
</div>

<script>
// Laadime galerii andmed andmebaasist
fetch('/api/pieces-with-collections')
    .then(response => response.json())
    .then(data => {
        const gallery = document.getElementById('gallery');
        gallery.innerHTML = '';
        
        data.forEach((piece, index) => {
            const galleryItem = document.createElement('div');
            galleryItem.className = 'gallery-item';
            
            // Kasutame olemasolevaid pilte või vaike placeholder
            const imageIndex = (index % 7) + 1; // pottery1.jpg kuni pottery7.jpg
            const imageSrc = `images/pottery${imageIndex}.jpg`;
            
            galleryItem.innerHTML = `
                <div class="image-frame">
                    <img src="${imageSrc}" alt="${piece.description || piece.name}">
                </div>
                <div class="description">${piece.collection_name} - ${piece.name}</div>
                <div class="static-description">${piece.description || 'Handmade ceramic piece'}</div>
            `;
            
            gallery.appendChild(galleryItem);
        });
        
        // Kui andmebaasis pole piisavalt andmeid, näita vaikimisi sisu
        if (data.length === 0) {
            gallery.innerHTML = `
                <div class="gallery-item">
                    <div class="image-frame">
                        <img src="images/pottery1.jpg" alt="Pottery piece">
                    </div>
                    <div class="description">Sample Collection - Sample Piece</div>
                    <div class="static-description">Beautiful handmade ceramic piece</div>
                </div>
            `;
        }
    })
    .catch(error => {
        console.error('Viga galerii andmete laadimisel:', error);
        // Kui API ei tööta, kuva vaikimisi sisu
        document.getElementById('gallery').innerHTML = `
            <div class="gallery-item">
                <div class="image-frame">
                    <img src="images/pottery1.jpg" alt="Pottery piece">
                </div>
                <div class="description">Sample Collection - Sample Piece</div>
                <div class="static-description">Beautiful handmade ceramic piece</div>
            </div>
        `;
    });
</script>

</body>
</html>
